(defn sys:render (world)
  (let map (.fetch world 'map))
  (for (entity (pos render)) in (query world  Position Renderable)
    (let idx (.xy-idx map [pos 'x] [pos 'y]))
    (when (.visible-tile? map idx)
      (set [pos 'x] [pos 'y] [render 'glyph] [render 'fg] [render 'bg]))))
